\subsection{First (non-abelian) cohomology vanish for Stone spaces}

\rednote{Should check things work well with a non-commutative group}

\begin{definition}
Assume given a type $X$ with $Y(x)$ a type and $G(x)$ a group depending on $x:X$. We define its its \v{C}ech sequence $\check{C}(X,Y,G)$ as:
\[\prod_{x:X}G(x)^{Y(x)} \overset{\delta_0}{\longrightarrow} \prod_{x:X}G(x)^{Y(x)^2} \overset{\delta_1}{\longrightarrow} \prod_{x:X}G(x)^{Y(x)^3} \]
with:
\[\delta_0(\alpha)_x(y_1,y_2) = \alpha_x(y_1)^{-1}\alpha_x(y_2)\]
\[\delta_0(\beta)_x(y_1,y_2,y_3) = \beta_x(y_2,y_3)\beta_x(y_1,y_3)^{-1}\beta_x(y_1,y_2)\]
We have that $\delta_1(\delta_0(\alpha)))_x(y_1,y_2,y_3) = 1$.
\end{definition}

\begin{lemma}
Assume given a type $X$ with $Y(x)$ a type and $G(x)$ a group depending on $x:X$. If we have a section $t:\prod_{x:X}Y(x)$, then $\check{C}(X,Y,G)$ is exact.
\end{lemma}

\begin{proof}
As in [Foundations].
\end{proof}

\rednote{Next lemma would not be needed with the alternative totally ordered approximation.}

We prove the \v{C}ech sequence of a map to a finite type is exact:

\begin{lemma}\label{vanishing-cech-finite-types}
Assume $F$ finite type with a type $X$ and a surjective map $q:X\to F$. We write $I(x)$ the fibers of $q$ over $x:F$. 

Assume given $A:F\to \mathrm{Ab}$, then the \v{C}ech sequence:
\[\prod_{x:F}A(x)^{I(x)} \to \prod_{x:F}A(x)^{I(x)^2}  \to \prod_{x:F}A(x)^{I(x)^3} \]
is exact.
\end{lemma}

\begin{proof}
Since $F$ is finite and exactness is stable under finite products, we can assume $F=1$, then $A$ is just an abelian group and $I$ an inhabited type, say with $0:I$. Then we are considering the sequence:
\[A^I \to A^{I^2} \to A^{I^3}\]
with the maps:
\[(a_i)_{i:I} \mapsto (a_i-a_j)_{i,j:I}\]
\[(a_{i,j})_{i,j:I} \mapsto (a_{i,j}+a_{j,k}-a_{i,k})_{i,j,k:I}\]
Assume $(a_{i,j})_{i,j:I}$ such that for all $i,j,k:I$ we have that $a_{i,j}+a_{j,k}=a_{i,k}$. 

First we have that $a_{i,i}+a_{i,i}=a_{i,i}$ so that $a_{i,i}=0$. Then $a_{i,j}+a_{j,i} = a_{i,i}$ gives that $a_{i,j} = -a_{j,i}$. Now we consider $(a_{i,0})_{i:I}$, which is sends to $(a_{i,0}-a_{j,0})_{i,j:I} = (a_{i,j})_{i,j:I}$. So the sequence is indeed exact.
\end{proof}

We want to prove that the vanishing of the \v{C}ech sequence of Stone spaces with overtly discrete coefficients is stable under sequential limit. It will rely heavily on Scott continuity. We need an auxiliary definition:

\rednote{We could bypass next definition by having a version of approximation of surjection between Stone spaces using actually finite type rather than merely finite types. We would need:

\begin{lemma}
We have a surjective map $\alpha : \left(\sum_{l:\N\to\N_+} \prod_{k:\N}\Fin(l_{k+1}) \to \Fin(l_k)\right) \to \sum_{X:\Stone}\propTrunc{X}$ defined by $(l,\alpha) \mapsto \mathrm{lim}_k\Fin(l_k)$. For $S:\Stone$, any map $T:S\to \sum_{X:\Stone}\propTrunc{X}$ merely factors through $\alpha$.
\end{lemma}

\begin{proof}
TODO use the approximation of any surjective $T\to S$ as finite types.
\end{proof}

I guess we also have that a finite cover of $S$ is the same as a map from $S$ to $\N$, meaning that $H^1(S,Aut(n)) = 0$ for all $n:\N$.

}

\begin{definition}
Assume given $S = \lim_kS_k$ sequential limits of Stone and $A:S\to \mathrm{Ab}_\ODisc$. Then we define:
\[A_k: S_k\to \mathrm{Ab}_{\ODisc}\]
\[A_k(x) = \prod_{y:S,y|_k=x} A(y)\]
By the dual to Tychonov, we have that $A_k(x)$ is overtly discrete. 

Moreover we for all $k:\N$ and $x:S_{k+1}$ we have a map:
\[A_k(x|_k) \to A_{k+1}(x)\]
\end{definition}

The two references in the proof are to variants of Scott continuity, in the directed univalence draft.

\begin{lemma}\label{vanishing-cech-stable-sequential-limits}
Assume given $S=\lim_kS_k$ and $S'=\lim_kS'_k$ limits of Stone spaces, and a surjective map of towers:
\begin{center}
\begin{tikzcd}
S_0' \ar[d] & S_1'\ar[l]\ar[d] & S_2'\ar[d]\ar[l]& \cdots\ar[l] \\
S_0 & S_1\ar[l] & S_2 \ar[l]& \cdots\ar[l] \\
\end{tikzcd}
\end{center}

We denote the fibers of the induced map $S'\to S$ over $x:S$ by $T(x)$ and the fibers of the map $S_k'\to S_k$ over $x:S_k$ by $T_k(x)$.

Assume given $A:S\to\mathrm{Ab}_\ODisc$ such that for all $k:\N$ the \v{C}ech sequence:
\[\prod_{x:S_k}A_k(x)^{T_k(x)} \to \prod_{x:S_k}A_k(x)^{T_k(x)^2}  \to \prod_{x:S_k}A_k(x)^{T_k(x)^3} \]
is exact. Then the \v{C}ech sequence:
\[\prod_{x:S}A(x)^{T(x)} \to \prod_{x:S}A(x)^{T(x)^2}  \to \prod_{x:S}A(x)^{T(x)^3} \]
is exact.
\end{lemma}

\begin{proof}
We prove that for any $l:\N$ we have that:
\[\mathrm{colim}_k \left(\prod_{x:S_k}A_k(x)^{T_k(x)^l}\right)  = \prod_{x:S}A(x)^{T(x)^l} \]
We conclude from this and exactness being stable under sequential colimit. We omit the verification that this is compatible with maps. 

We have that:
\[\prod_{x:S_k}A_k(x)^{T_k(x)^l} = \prod_{x:S_k}\prod_{y:S,y|_k=x} A(y)^{T_k(x)^l} = \prod_{y:S} A(y)^{T_k(y|_k)^l}\]
and by \Cref{scott-continuity-right} we have that:
\[\mathrm{colim}_k\left(\prod_{y:S} A(y)^{T_k(y|_k)^l}\right) = \prod_{y:S} \mathrm{colim}_k\left( A(y)^{T_k(y|_k)^l} \right)\]
but by \Cref{scott-continuity} we have that:
\[\mathrm{colim}_k\left( A(y)^{T_k(y|_k)^l} \right) = A(y)^{\lim_k T_k(y|_k)^l}\]
and we can see by commutation of limits that:
\[\lim_k T_k(y|_k)^l = T(y)^l\]
\end{proof}

We give some result on \v{C}ech sequences and cohomology. It works in plain HoTT and is certainly not new.

\begin{lemma}\label{cocyle-being-coboundary}
Assume given a set $X$ with $Y(x)$ an inhabited set depending on $x:X$. Moreover, assume given $G(x)$ a group depending on $x:X$ with:
\[\phi:\prod_{x:X}BG(x)\]
and:
\[\psi:\prod_{x:X}(\phi(x)=*)^{Y(x)}\]
If $\check{C}(X,Y,G)$ is exact then $\phi=*$.
\end{lemma}

\begin{proof}
We define:
\[\beta : \prod_{x:X} G(x)^{T(x)^2}\]
by having $\beta_x(y_1,y_2) = \psi_x(y_1)^{-1} \cdot \psi_x(y_2)$. It is easy to check that it is a cocycle in the given sequence (meaning $\delta_1(\beta) = 1$), so that by exactness there is $\alpha:\prod_{x:X}G(x)^{Y(x)}$ such that for all $x:X$ and $y_1,y_2:Y(x)$ we have that:
\[\beta_x(y_1,y_2)=\alpha_x(y_1)^{-1}\cdot \alpha_x(y_2)\]
Then we define:
\[\psi' : \prod_{x:X}(\phi(x)=*)^{Y(x)}\]
\[\psi'_x(y) = \psi_x(y)\cdot \alpha_x(y)^{-1}\]
so that for all $x:X$ and $y_1,y_2:Y(x)$ we have that:
\begin{eqnarray}
\psi'_x(y_1)^{-1}\cdot\psi'_x(y_2) &=& \alpha_x(y_1) \cdot \psi_x(y_1)^{-1}\cdot \psi_x(y_2)\cdot \alpha_x(y_2)^{-1}\nonumber\\
 &=&  \alpha_x(y_1) \cdot \beta_x(y_1,y_2)\cdot \alpha_x(y_2)^{-1} \nonumber\\
 &=&  \alpha_x(y_1) \cdot\alpha_x(y_1)^{-1} \cdot\alpha_x(y_2)\cdot \alpha_x(y_2)^{-1} \nonumber\\ 
 &=& 1 \nonumber
 \end{eqnarray}
This means that $\psi'_x(y_1) = \psi'(y_2)$, so that $\psi'$ factors through $S$, giving a proof of $\phi=*$.
\end{proof}


Now we just have to assemble the pieces.

\begin{lemma}\label{vanishing-1-cohomology-stone}
Let $S$ be Stone and $G: S\to \mathrm{Gp}_\ODisc$. Then:
\[H^1(S,G) = 0\]
\end{lemma}

\begin{proof}
Assume given:
\[\phi:\prod_{s:S}BG(x)\]
we have that:
\[\prod_{x:S}\propTrunc{\phi(x)=*}\]
so that by local choice there merely exists $T(x)$ inhabited Stone space depending on $x:S$ with
\[\alpha:\prod_{x:S}(\phi(x)=*)^{T(x)}\]
In order to conclude by applying \Cref{cocyle-being-coboundary}, it is enough to prove that the \v{C}ech sequence:
\[\prod_{x:S}G(x)^{T(x)} \to \prod_{x:S}G(x)^{T(x)^2}  \to \prod_{x:S}G(x)^{T(x)^3} \]
is exact.

By \Cref{TODO} we know that any surjective map between Stone spaces is a sequential limit of surjective maps between finite types. So by applying \Cref{vanishing-cech-stable-sequential-limits} we see it is enough to prove the exactness of the exact sequence for maps between finite types, and this is \Cref{vanishing-cech-finite-types}.
\end{proof}

\subsection{Stone spaces are acyclic}


\begin{theorem}\label{eilenberg-exponentials}
Assume given $S:\Stone$ and $A:S\to \mathrm{Ab}_\ODisc$, then for all $n:\N$ we have that the canonical map:
\[K(\prod_{x:S}A(x),n)\to \prod_{x:S}K(A(x),n)\]
is an equivalence.
\end{theorem}

\begin{proof}
We proceed by induction on $n$. If $n=0$ this is clear.

Assume the result for $n$, let us prove it for $n+1$. 

First we prove that the map:
\[K(\prod_{x:S}A(x),n+1) \to \prod_{x:S}K(A(x),n+1)\]
is an embedding. Since the source is pointed and connected it is enough to prove the induced map:
\[\Omega(K(\prod_{x:S}A(x),n+1)) \to \Omega(\prod_{x:S}K(A(x),n+1))\]
is an equivalence, but this map is equal to the canonical map:
\[K(\prod_{x:S}A(x),n) \to \prod_{x:S}K(A(x),n)\]
so we conclude by induction hypothesis.

Now it is enough to prove that any $H^{n+1}(S,A) = 0$ to conclude. Indeed then $\prod_{x:S}K(A(x),n+1)$ is connected, so the map is surjective and we can conclude. If $n=0$ this is the abelian version of \Cref{vanishing-1-cohomology-stone}. We can assume $n\geq 1$.

Given $\alpha : H^{n+1}(S,A)$, by local choice we get $T(x)$ Stone inhabited depending on $x:S$ such that $\alpha$ is send by $0$ through the map:
\[H^{n+1}(\Sigma_{x:S}T(x),A)\]
Since $K(A(x)^{T(x)},n+1)\to K(A(x),n+1)^{T(x)}$ is an embedding by induction hypothesis, we get that $H^{n+1}(S,\lambda x. A(x)^{T(x)})\to H^{n+1}(\Sigma_{x:S}T(x),A)$ is injective, so that $\alpha$ is send to $0$ by the map:
\[H^{n+1}(S,A)\to H^{n+1}(S,\lambda x. A(x)^{T(x)})\]
Then we consider the exact sequence depending on $x:S$:
\[0\to A_x\to A(x)^{T(x)}\to L(x)\to 0\]
so we have an exact sequence: 
\[H^{n}(S,L)\to H^{n+1}(S,A)\to H^{n+1}(S,\lambda x. A(x)^{T(x)})\]
where $\alpha:H^{n+1}(S,A)$ is send to $0$. By induction we have that $\prod_{x:S}K(L(x),n) = K(\prod_{x:S}L(x),n)$ so that $H^{n}(S,L)=0$ since $n\geq 1$. Then $\alpha = 0$ and we can conclude.
\end{proof}

\begin{corollary}\label{vanishing-cohomology-stone}
Let $S$ be Stone and $A:S\to\mathrm{Ab}_\ODisc$. Then for all $n>0$ we have that:
\[H^n(S,A) = 0\]
\end{corollary}


\subsection{\v{C}ech cohomology}

\begin{definition}
A \v{C}ech cover for a type $X$ consists of a surjective map:
\[f:S\to X\]
where $S$ is Stone and for all $x:X$ the fiber $S_x$ of $f$ over $x$ is Stone.
\end{definition}

Next lemma show that cohomology interact well with \v{C}ech cover. It will be used later to prove that cohomology and \v{C}ech cohomology agree.

\begin{lemma}\label{inductive-definition-cohomology}
Assume given $X$ a type with a \v{C}ech cover:
\[f:S\to X\]
as well as $A:X\to \mathrm{Ab}_\ODisc$.

For all $n\geq 1$ we have an exact sequence:
\[H^{n-1}(X,x\mapsto A_x^{S_x}) \to H^{n-1}(X,L)\to H^n(X,A)\to 0\]
natural in $A$, where $L_x = A_x^{S_x}/A_x$.
\end{lemma}

\begin{proof}
Using the long exact sequence associated to:
\[0\to A_x\to A_x^{S_x}\to L_x\to 0\]
by \Cref{vanishing-cohomology-stone} it is enough to prove that for all $n\geq 1$ we have:
\[H^n(x:X,A_x^{S_x}) = 0\]
But by \Cref{eilenberg-exponentials} we have that:
\[\prod_{x:X}K(A_x^{S_x},n) = \prod_{x:S}K(A_x,n) = K(\prod_{x:S}A_x,n)\]
\end{proof}

\begin{definition}\label{cech-sequence-definition}
Assume given a \v{C}ech cover
\[f:S\to X\]
and $A:X\to\mathrm{Ab}_\ODisc$.

Then we define the \v{C}ech complex by:
\[\prod_{x:X}A_x^{S_x} \to \prod_{x:X}A_x^{S_x\times S_x} \to \cdots\]
with the boundary maps defined as expected, that is:
\[\delta(\alpha)(x,u_0,\cdots,u_n) = \sum_{i=0}^n (-1)^i\alpha(x,u_0,\cdots,\hat{u_i},\cdots,u_n)\]
Then the \v{C}ech cohomology:
\[\check{H}^k(x:X,A_x)\]
is defined as the $k$-th homology group of the \v{C}ech complex.
\end{definition}

\begin{lemma}\label{long-exact-cech-cohomology}
Assume given a \v{C}ech cover:
\[f:S\to X\]
If we are given a short exact sequence of overtly discrete abelian group:
\[0\to A_x\to B_x\to C_x\to 0\]
depending on $x:X$, there is a long exact sequence of \v{C}ech cohomology groups:
\[\check{H}^0(X,A) \to\check{H}^0(X,B) \to\check{H}^0(X,C) \to\check{H}^1(X,A) \to\check{H}^1(X,B) \to\check{H}^1(X,C) \to\cdots \]
Moreover this long exact sequence is natural in the short exact sequence.
\end{lemma}

\begin{proof}
We just use the fact that all elements $\sum_{x:X} T_x^{k+1}$ in the \v{C}ech complex are Stone spaces, so a short exact sequence of overtly discrete abelian group induces a short exact of \v{C}ech complexes by \Cref{vanishing-cohomology-stone}.
\end{proof}

\begin{lemma}\label{inductive-definition-cech-cohomology}
Assume given a \v{C}ech cover:
\[f:S\to X\]
and $A:X\to\mathrm{Ab}_\ODisc$.

For all $n\geq 1$ we have an exact sequence:
\[\check{H}^{n-1}(X,x\mapsto A_x^{S_x}) \to \check{H}^{n-1}(X,L)\to \check{H}^n(X,A)\to 0\]
natural in $A$ where $L_x=A_x^{S_x}/A_x$.
\end{lemma}

\begin{proof}
By \Cref{long-exact-cech-cohomology}, it is enough to prove $\check{H}^n(X,x\mapsto A_x^{S_x}) = 0$ 
\rednote{maybe we could have this as an auxiliary lemma, as it does not use anything on $X$, $S$ and $A$? It can be found in Foundation I think.}
for all $n\geq 1$. Indeed assume given:
\[\alpha : \prod_{x:X} S_x^{n+1}\to S_x\to A_x\]
such that $\delta(\alpha) = 0$, i.e. for all $x:X$ and $u_0,\cdots, u_{n+1},v:S_x$ we have that:
\[\sum_{i=0}^{n+1}(-1)^i\alpha(x,u_0,\cdots,  \hat{u_i},\cdots ,u_{n+1},v) = 0\]
Then we define:
\[\beta : \prod_{x:X} S_x^{n}\to S_x\to A_x\]
\[\beta(x,u_0,\cdots,u_{n-1},v) = (-1)^n\alpha(x,u_0,\cdots,u_{n-1},v,v)\]
and then:
\[\delta(\beta)(x,u_0,\cdots,u_{n},v) = (-1)^n\sum_{i=0}^{n} (-1)^i \alpha(x,u_0,\cdots,\hat{u_i},\cdots,u_n,v,v) \]
\[= \alpha(x,u_0,\cdots,u_n,v)\]
\end{proof}

\begin{theorem}
Assume given a \v{C}ech cover:
\[f:S\to X\]
and $A:X\to\mathrm{Ab}_\ODisc$.

Then we have a natural isomorphism:
\[H^n(X,A) = \check{H}^n(X,A)\]
\end{theorem}

\begin{proof}
We proceed by induction on $n$. For $n=0$ we need to prove that maps:
\[\alpha:\prod_{s:S}A_{f(s)}\]
such that whenever $f(s)=f(t)$ we have that $\alpha(s) = \alpha(t)$ are naturally isomorphic to:
\[\prod_{x:X}A_x\]
This is immediate.

For the inductive step we use \Cref{inductive-definition-cohomology} and \Cref{inductive-definition-cech-cohomology}. Naturality comes from the naturality of the exact sequences.
\end{proof}


\subsection{The unit interval is acyclic}

\begin{proposition}\label{vanishing-cohomology-interval}
For all $A$ overtly discrete and all $k$ we have that:
\[H^k(\mathbb{I},A) = 0\]
\end{proposition}

\begin{proof}
TODO
\end{proof}
